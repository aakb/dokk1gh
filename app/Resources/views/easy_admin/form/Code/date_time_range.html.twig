<div style="display: none">{{ markup | raw }}</div>

<div class="date-time-range">
  {% if name == 'startTime' %}

    <div class="date-time-range-date">
      <input id="{{ id }}-picker" class="form-control" type="text" value="{{ value | date(form_format_date) }}"/>
    </div>

    <script>
     (typeof gh !== 'undefined') || (gh = {});
     (typeof gh.code !== 'undefined') || (gh.code = {});

     gh.code.updateTimes = function(initialize) {
       var date = $('#' + {{ id | json_encode | raw }} + '-picker').datepicker('getUTCDate');
       var timeStart = $('#' + {{ id | replace({'startTime': 'endTime'}) | json_encode | raw }} + '-time-start');
       var timeEnd = $('#' + {{ id | replace({'startTime': 'endTime'}) | json_encode | raw }} + '-time-end');

       if (initialize === true) {
         // Get time start and end from entity.
         var startTime = moment($('#' + {{ id | json_encode | raw }}).val());
         var endTime = moment($('#' + {{ id | replace({'startTime': 'endTime'}) | json_encode | raw }}).val());
         timeStart.val(startTime.format('HH:mm'));
         timeEnd.val(endTime.format('HH:mm'));
       }

       var startTime = moment(date);
       var tokens = timeStart.val().split(':');
       startTime.hour(parseInt(tokens[0]));
       startTime.minute(parseInt(tokens[1]));
       startTime.second(0);

       var endTime = moment(date);
       tokens = timeEnd.val().split(':');
       endTime.hour(parseInt(tokens[0]));
       endTime.minute(parseInt(tokens[1]));
       endTime.second(0);

       $('#' + {{ id | json_encode | raw }}).val(startTime.format());
       $('#' + {{ id | replace({'startTime': 'endTime'}) | json_encode | raw }}).val(endTime.format());
     };
     (function ($) { $(function() {
       gh.code.datePicker = $('#' + {{ id | json_encode | raw }} + '-picker').datepicker({
         language: {{ locale | json_encode | raw }},
         format: {{ form_format_date_js | json_encode | raw }},
         startDate: 'now',
         daysOfWeekDisabled: [0, 6],
         autoclose: true
       }).on('changeDate', gh.code.updateTimes);
       gh.code.updateTimes(true);
     })}(jQuery))</script>

  {% elseif easyadmin.entity.class == 'AppBundle\\Entity\\Code' and name == 'endTime' %}

    {# Time span selectors #}
    <div class="date-time-range-time date-time-range-time-start">
      <select class="form-control" id="{{ id }}-time-start">
        {% for i in 8..16 %}
          <option>{{ '%02d' | format(i)}}:00</option>
          <option>{{ '%02d' | format(i)}}:30</option>
        {% endfor %}
      </select>
    </div>
    â€“
    {# no space between select elements #}
    <div class="date-time-range-time date-time-range-time-end">
      <select class="form-control" id="{{ id }}-time-end">
        {% for i in 9..17 %}
          <option>{{ '%02d' | format(i)}}:00</option>
          <option>{{ '%02d' | format(i)}}:30</option>
        {% endfor %}
      </select>
    </div>

    <script>
     (function ($) {
       $([
         '#' + {{ id | json_encode | raw }} + '-time-start',
         '#' + {{ id | json_encode | raw }} + '-time-end'
       ].join()).on('change', gh.code.updateTimes);
     }(jQuery))</script>

  {% endif %}
</div>
